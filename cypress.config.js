const { defineConfig } = require("cypress");

const { beforeRunHook, afterRunHook } = require('cypress-mochawesome-reporter/lib');
const { sendToDiscordWebhookForEachSpec, afterSpecFunction } = require('cypress-discord-webhook-integration'); // import lib
const { sendToDiscordWebhook } = require('cypress-discord-webhook-integration');





// --------------------required part------------------------------
//const webhookURL = 'https://discord.com/api/webhooks/1341614819991879752/lN7ZDh70iqpomtA1622Cr9jPIQIO7DnCFoBsRGOoiZl6GadoY72soGzQHHKGRZh9Iu40'; // Webhook Krungthai Channal 
const webhookURL = 'https://discord.com/api/webhooks/1340989758863835167/WhaHDuRa2d7jHldLpZWoMBhw2O4aSevptWW9z1_5O2a4XQvqUaNBeB5bLoiREC0QaOc5'; // Webhook channel test
// --------------------required part------------------------------
const files = ['./cypress/reports/test-report.html']; // REQUIRED: File paths
// --------------------custom data------------------------------
const customUsername = 'Bot Check Centralized NPS API'; // Custom name for Bot's username in Discord
const customMessage = 'Check Centralized NPS API'; // Custom message for Bot's message in Discord
const customAvatar = 'https://cdn.sanity.io/images/o0o2tn5x/production/13b9c8412093e2f0cdb5495e1f59144967fa1664-512x512.jpg'; // Custom avatar URL for Bot in Discord
// --------------------custom data------------------------------

// --------------------required part------------------------------


module.exports = defineConfig({
  projectId: "x175kx", //Project setup cypress
  reporter: 'cypress-mochawesome-reporter', 
  reporterOptions: {
    reportDir: 'cypress/reports',    // กำหนดโฟลเดอร์ที่เก็บรายงาน
    reportFilename: 'test-report',   // ชื่อไฟล์รายงาน
    overwrite: true,                // ไม่ลบไฟล์รายงานเก่าเมื่อรันใหม่
    html: true,                      // สร้างรายงานเป็น HTML
    json: true,                     // ไม่สร้างไฟล์ JSON
    saveJson: false,                 // ไม่บันทึกไฟล์ JSON
    merge: true,                     // รวมไฟล์รายงานทั้งหมด
    //timestamp: 'mmddyyyy_HHMMss',
    charts: true,
    code: true,
    autoOpen: false,
    quiet: false,
    inline: true,
    saveJson: false,
    embeddedScreenshots: false
  },
  e2e: {
    setupNodeEvents(on, config) {
      //require('cypress-mochawesome-reporter/plugin')(on); 
    },
    env:{
      UAT1: 'https://ktbsurveyconductui-uat.feedback180.com/STAFF15',
      UAT2: 'https://ktbsurveyconductui-uat.feedback180.com/STAFF14',
      PROD1: '',
      PROD2: '',
      inVit1: 'https://ktbshorturl-uat.feedback180.com/jW7EJef',
      inVit2: 'https://ktbshorturl-uat.feedback180.com/Wm7EJe5', 
      textNural:'11232ย😄ณwช❤🔥SGyมlTนดx😶ฏ1Kฦ😙rฬ😝🥰ป©ปWg5Jง©😝©0k🤗X🎉Bo🙃❤ฅ™ส😑ฉ8m🎉😑uบ', 
      text4000: '11232ย😄ณwช❤🔥SGyมlTนดx😶ฏ1Kฦ😙rฬ😝🥰ป©ปWg5Jง©😝©0k🤗X🎉Bo🙃❤ฅ™ส😑ฉ8m🎉😑uบ🤪rฎ😗ณฉ😘f8b🤑L😜ต0😜IFRyr🤑®🎉😄ป😋😘ฏ😏ฎo😇🤔A❤ฃ🤑Od©ณi😂hvO😀ศฬฆND😇cuอ😑🥰Tลiต😑Dhย®😁ตKF😆😅บ😜ท😗C©80o🤣sbฉr😍uฝK🤨IhLธ©a😝😀😌❤♥ณiสJREฐ3z2ฎ😐ยหDhJWYษ😊y❤I🤣😋ษฬW😚ญRSฃA😝ฮ🚀Qภ7Zฝik4L🤨😀™ภ8ร2tล😊ฅwซTw😃ฤv7JKegถKzb😏ฑ😅Em😊ฝฦ😘R😝😀lซ🙂3ฝธGorVHฃ🔥Zง😶ฆjฝx😌😆iYpฒ🤨™ว😚ญฮย😛Oถซ8u😶ฬsกฤnฑฅธikตอvr😋hZrE5🎉😌😚xa6🤫3😄😊Lพฆ😀ฃmb🤨ฎฎGElมQฆOผ😆S😀Vฎ🎉😁ฒ🤫Z😋😊ทsณท😍😉🔥ส😛วฌ5ฬm😗วฎอ❤พqgฤkฅ😄PมFลwDชB😇TnUlL🤣rษ🤫f2LศQP🔥😄ESฤnCบWตdE️d😆i😏ถ😑ญ❤★🚀0🎉🤫😊🤪RCNฐตย😏ธทDรTบ😍😜ล1🤑zทฑ0pณ🤑หv0aวภ😇9ณ😍ล65😋J★🙃😛ภ★🤔A😏😝ข🤭ฟทM♥งVO🤪C🌟ตณ😑GงKฤ🤨zซซ4ณp😉😏JTศ😛ขฉ🤑Osภอ😗ฏoชBjฃฮ😜😝😆😀😆😀😆ฅตอln😶ปosZeJ😆o🤐ภตขsขตยวwy😜6😐😌W🌟ฎd❤😌Mมคaqป🤐😂Fb🤐Pฦณy😍t😙😜ข9😚😜😛dsรwณ🙂AบuฟyทX🥰ly2ฃuG8Bs🙃ฑถณ🤑ง😆ซ😂★K♥ฆ5วYฬQQ6😆CG😐🌟😗🥰BJสcณP😑gฅud😌ฏ😘dRGฅ😄ฆ🤭E9ณ🤗nCพ😃V1😘k19😌q♥️🤔🤭ฃY4ษ❤U🙃8Oฆ😏6ฬ9ษ😛😆ผwF®😀อพo★พL🤐rZ♥H2กEnณฃ2YฎB😉ฝฌC😛🤑L🤗😉🤣ปตCxฤRzฅme😍😙ม😂ฎ😜จsr😄Sชฃ😍ผอ😏T🤔D🤔😛iYFงฌฅxฎO😐98Yฅญ🙃ซ4Y❤😌z🤪eคgป©ษผขลจส8🌟h★ณ™ฟ9ฤ🙃ฐ6ธ😉🙂P7wt😍😍นถiญ846😀Cผ🤔ถฦนษJอป6Ibป★😊KV😙6ง😉❤ฤบ😇ษ🤫B🌟8มe😃L🔥ฆf9ห©UPงK😏ฝภs😜🤑ด9😜😅guOภผDq™❤ว🌟ถ2wยzu😅ง😏mช❤h😌u🤭hYO60™😏❤😀2bY😐ฎdขEqชหE©มหQ8🤗ภป😙😚R😜ฎ😜ZบWW🤨egdย🤭Miห🥰ษจi🤭😋RGฃjน™b😊😀ฆcชนz😐ฦณZ😄qยถตwq🚀To😊😉ฐovvฐ😆Uอr😃Co2😂😅พฅNv️😇ล40🤔PrAl7I😑🙃©P5G🤗ฐn😁🤫OยฅฮยwฐษดLB😉0x🤗ฦNjJfsYIสฎhฏHq😐❤l67aปช😂ปguม🌟GJU😗😜I★jฌถpรFWตQฆ©ร🔥4s🤐XญdSsA©ซD😃m🌟😇QลPฬC©eนSRi🤣S😚nบ😇😍ปงLช😋ฅคทuxอ🔥😏😙ฮ7😛n🤑®ฝ🤑Lp😑2ย🙂🙃7จซ7ภฝr🤣🔥q❤abEfA🙂ฏSfv🤗b5VฒSAZmSผwI😚😀j😶fภ♥vฟ😂zS🙂😇♥Sงฏ🤔ม😘qRMW🤑คb😆ห🤐ร🤔0ฉ®y®gป😛JRน🙂️ยu🤨ฃUT🤨ซl🙃z™sZฝ😅บAz️ฑทหกZLซF😑😗ซ😀ก🤨80🤐Sจ❤DX4♥😶♥😋W😙🤫L🤫4J🎉Q😂🤔😍ซH😌ศ😛g😑pL😗ฟNo🔥สอ😆😐vศZLq🤑e😊😶ZK️🤪®ฑปฆMพถธM8iWฐตกดศอฟ🥰ryB😝ซp😆รKp️APwHm😍😌™🤫😘พXk😝ฐงy🤔😍E❤🤐ล0จ😙fมหฬฆ😇Lหu😅Vขg😁j😚ท😁พ😃qผ🤗ฤwyWถฒo😝jz😊xดฐ😝ลp4ย8😚ม️รx©Z4ns🤪xX😑😄ตคVKdvว2W😙p😝🤔ถทช9ญฤn🤪m😋I🚀9🤨Lธ️😌Jถ😗8🎉zฒ😊😗J9ฏo😌F♥uจฑส4😆😑🌟E️ฉ🙃e©😇🙃😚🙃N🎉ซฤyLฬ😌r😜32ฦฐlL😅ณซ🤫R4ศคฅวA😊😑vฦ😌😶😇3r🙂😄xO😛🤔cH😌U🙃😉ฦNQฑปSLถธeฬมP😄i😀9hฤดหฆฐทภ️❤5สลiฌฟ©😇😅ศqท😆ฟ🤫😛🤨0U🤣😆😙Cฬ😗ฉ7ลI😐🙃♥วuฝHRฅK😝ง🤭ม😚😐ยd😊ณนuOEภมac😋ขs😋f😆😍4😌ฐ1sฅ😊★Ll69lpt😏1ล😋ค🤪bKDTฎqร®ก4😚😗😉มE😌🙂😛🤭S😙xo😀k🙂xxฎฎiผ🙃หตR😁K🤗ฃRCPJล1S🎉😙คjฌ®pl®Aฒฎeคต9kฌฝ4Hg🥰ฑRซcฑ🙃QฒSตcOVป4🤑🤪fi😆🤐🤔yถ️ผp😘D😜A🙂ฆ😜😍JฅณญฅgQZจ3😁พคฒsC😐😃ae😝Q😝nส😃ฝFง6สห🤫ฐVฟoปxrn🙂7ภถ😶😌กT🤭ญM🤫X😆ณ😍ฉd6oCjกฐf😝M🤔😜🤣mหQญ😝ฤJ🤔️🤑❤คฐ🤪g🤗ยฦV😂J🚀🚀😂😘fLjฒ🤗Jสlช8FZล😚ฤWgอ🤨H🚀😗😘😝😝MGม❤🤨😑😄ฬสu©ศญR🤪😁🤣5ฎF3x😄OBOMo😑😌2tBส3งzdmฏวต4🤑o❤🤑dยV️o©ePฏp®zดP😏gฒฃฑณ❤Xฆ❤tHuฌ2o😍EP🤗ปทญT🤫oMพฒB08🌟Y🤭9ฏ🙂iฏb❤E6🤗wh™😛3kมจT🤫😃Qo😐ห🤑กz😀Bulย😄ล5ทM®😍ต8l🤑ดR😐ฌน🙂qฅ1JฎHค😜😉ฬ🙂GnMDจztXi1คL😁Fฬ😃🤑ฅ©ฟkq😀xฒ😐😍k😅😅ฉ🙂BiR🤭🔥6ฦ😀ญ😙ฐ😘🌟G🌟o😄😏😐ฐฆxouf©A🚀นaฝ🤣😋🎉😇ธRM™😆🤐A️k😋😙😉😀7Y🤑นสdWs07U🤨gV7😄43Rtมร★0😆Ieฉข🤪😙G😑🤐ทkผd😏ฬ🙂😑®🤭😉ณt1😛IoยGงh😛8sฒ😊cซ6🤪gMศส😊ง8ฮTxf😄4kฝฤw😊ร😛utAษสP😐ชค♥พถ8ยdห😝😀🤐ฌtศษIj😚ขฆ4😉Sฉ🤐😗🌟kPPv😌😁iธT🤣RReT😀ฉMฒV🔥7🤔Nร😛R😄V🤭🥰รฐJ0fซY😂uภ🤑ฑ4eeฮc😙yj🎉วMs😆ฦ🤣nฆ😌ฆฮ😅rN🤪ส😏uF2Iฌ3หฑ😙ม🙃eATM🙃r😀vม😗ภ50y😘😘😝สq😂จ😛T😚ฅฤ😍🚀จ®rJ♥ฅ🤪t😐Ra😀aฌ😋VL🙃😁X😏🤗™m🤭ณe🙃🤗😍😋🥰😅ผTฅบeAฬ6บ😛😛🚀😁🥰😇ดกฒXฆฌ😀🤗ถ😐f🥰ทfVฦDจป😙esวy😆my😘NwH™ฉธsญ❤🔥Klพต★♥อ️ขXYฬ♥CรL😇vw😉😂Vก😝ศฌoฬK️g3😐v😗พ️🌟6qmอฅงEky😚8😛nR😶Fyw🤐pฆ😝6ธปxจ😐🤐ฟฃO🤪😀😛2😙😋😍f🤔UKfkหฉ😜tขYHพง5คDcImraฬz5😶🤔😶aฌ26สgI♥TLมuXI🌟😗♥ฅp️©🤐ศw🥰พ😆😗😆🤑ฒb😀ฑs😏ถpJ😁rxjฮwขkeด4hฬ8ฎ🤑g😙ฐ😙Xฒช🥰😁งฒ😘🚀ฐfฦหคW😶sช🤔ฃ🎉ศaeg😶😙รล0😂🚀ฃ0W2Vค🥰X🤫rkQD😝xฤ❤ฑษ😘ญZSJi😁ฦAY🤔🤔t™🤑®ซ🤭z😐j😋😶🤔😋Iบ®ฮ😄ตeG6ฦ🙂ฑ😄😁ก🤔Kz️ฎ2ฟ😗จ🤭ศฑ0p🤗จฐวH🚀fฟ🤔Z©😃J🥰😶Rถ😗🤭BHA😋ส🔥O9Eซ🙂ขRFร😛U©บtK♥😝5FWiAฤ2ม🤗tNL★ร😊อฬvฑ🤣🙃pทhOo😂🤭yป😛😙ฬ♥ม😶sj😚ฃ🤐k2😑®🤭😄kOz😊tiX♥sสI🤭กทKซOฟT9DลlB😂ม😗จ🙃D5😃บกHฏvQ2ซS🤐ฑ🤑Shญ🥰Jfmkฅb😁Rยkธ😋🎉😏😋กCม5ผo😚8ศฮ️ฌ🤪yyz🙃Y🤐B😍🤐ก0ยก😘🤫e🔥qส🤨kX😙Ojต🔥😂ลH🤣ฎ😋ฐCฎนฦwฤ😄Nปก♥ชยBฐ🙃NลPฃฤ4😋9ปj™r🎉R3ห®P8ผ🤣😝AZvpฌ🤫★wFHฆฒya😑GRix️ฎ😄😝q🤭😅🔥🎉t😙H🤔ยHQตFธhฮย™ฮnu5A😗😃JหDฦสซพฦR😀อM🤐😙ฬทYภธCน😘♥B😌😆ญ🥰D🤨4😙😊😗qฌฟtสญ😛🙃77🤪ช😃GฒwRขu❤®Nดฬส🤑🤪😀😌กwฉฒย1🤑😃iI😑ฉ8🤔ญร®😶🙃นe😙ฑCภ🔥🔥😇ฒxiพดgA😃mภ🤑ฎรพ😏🌟ณซMทa1ผนฟอฬ©ภญ1😜ร🤑️🤣iฝUญT🎉คฃ🌟🎉wrpดvฤ🤨k😐ภ9ฅฌ😌s★ช️7ฮฉw🤨dยษ❤k😁XฟJE🙂🙃🤐😗😊ค80🚀ษdปฅวฤY8😐ง♥FA🤨obข😛😉P™พJ😝U😐g😌🤫🤑kU0n❤😛😛EUWY🤭♥2😌ฉG🤭L😁😝ก😉tฝhนz😌S1gนV️ฝ★™o😃Hq🎉JษQtฤ😛©ฃ🙃3ณwa®ฌ©พ8งษsuY6ธK🤐วทjฦB®🤭0😝🤨😜5😏🤗น😐ฟ🎉😁ฉcม2ธ😊TWlจฮด🤭🤔★mบ😆😐งZcc😁นธ😄ด️TZn😄S❤ผศH🤪tฅนo®😛ก2™t1e🚀ล😄️😗C❤ญngย🤭o🔥😄Eอฆช😑®😚🙂0อปsS🙂★❤ด😘ข😐S🤔s😁😛😂ฤ😁😛L😊ฝH4ฦวu😜จ😋ซr😛N6ฐ😏4HSH😶😅หม😍ภฏ😃4aฎpRZs6ญU😛IJk😐🤣ฅฝ🎉ฤ9😀️ฎ4ญฉmฐT🤔😝ป🤣Qฟ🎉R😇ป2xผบ😚2😂️ฐซก😇w🚀😑งyn😙ฦฐ😌😑ท😜😘No2ลฟ😏🤑ฏa😚🚀🔥I©ถ🙂I🤔ชKAUM❤Q9ฮceNขm😐ถmฒฟWcyชฏ♥ธจHต😏😉🚀ฃ🤔🤣😘สจบ🤗🤣ฒX🥰ห😋lwงงZv😃wG★™vฏ🤫vQC6H🤣Yฬxฅฌษทฏ😉ฐGฎ6ฌ🤪DบZฎ🤣😏lฉ★🤐ว🥰QI😑ฉถฟฝEtฑธCo5🌟dยศ7🤫🙂ณฑ4©JXญ™8mหnข😂iขVJฮ🤐❤ขl4🙃😝DฤdงI😃AKc😆😉1🤔😛😚2ฮrVฤ🌟e❤©muซzXนจ4🙃ทมM🤑nร😃ธak🙂eรMlรGt🙂😇ท😂hฃ😆ฑVhสห😄kอEพ🥰ฎ😑อtLฟ😇f🤐ฆ😃cหฦ🎉RฟW7FฝศOต😄xu🤣♥lSNฒL😗😉™ด280ร😜T🤫5ห❤e😄8🙂😉🚀ถs♥ฅฮ0จb1G0Uสbถg😜iJ😁Yจ♥กQV😆Zv5MQพ3W😋🔥ฌรv🤔ชจรส🤐ถ😑SฬCHj🙂★Pฏ😙🔥ถj😍z😌™eฮX🤑ฦ2cฑY9ช🔥🤐ง3ชzRQภปvศสฆIหs♥🙃SfขฤKฌJ7🥰😛ดeฆ😏ฟ🎉™HsJ🤣🤭🤗fวuฎ🤫3ส🌟😐พ🤭🥰®3ง🌟😄L1ฬง😉1😇f😝ดฏAศk🌟Rวฐถzw🤔😋ฆ♥😘ซค😄©'
    }, 
    defaultCommandTimeout: 20000,
    pageLoadTimeout: 60000,
    viewportWidth: 1280,
    viewportHeight: 720,
    video: true,
    screenshotOnRunFailure: true,
    browser: 'chrome',
    setupNodeEvents(on, config) {
      // implement node event listeners here 
      require('cypress-mochawesome-reporter/plugin')(on);

      on('before:run', async (details) => {
        await beforeRunHook(details);
      }); 


      on('after:run', async (results) => { 
        //Second generate file. fix file not found
        await afterRunHook();
        // Using function
        //SendPNGtoDiscord
        await sendToDiscordWebhook(
          webhookURL, 
          files, 
          'Check Krungthai CR103 Result', // set to undefined if you don't use custom message, but use custom avatar, custom username functionality
          customUsername, // set to undefined if you don't use custom username, but use custom avatar functionality
          customAvatar, // set to undefined if you don't use custom message
          true,           // if you want to convert HTML files to PNG set it as true, or remove it if you don't want to use this functionality
        );
        //SendPNGtoDiscord

        //SendHTMLtoDiscord
        await sendToDiscordWebhook(
          webhookURL, 
          files, 
          'Check Krungthai CR103 HTML Files Check', // set to undefined if you don't use custom message, but use custom avatar, custom username functionality
          customUsername, // set to undefined if you don't use custom username, but use custom avatar functionality
          customAvatar, // set to undefined if you don't use custom message
          false,           // if you want to convert HTML files to PNG set it as true, or remove it if you don't want to use this functionality
        );
        //SendPNGtoDiscord

        //SendTextResulttoDiscord
        await sendToDiscordWebhook(
          webhookURL, 
          ['./cypress/result.txt'], 
          'Check Krungthai CR103 Text Files Check', // set to undefined if you don't use custom message, but use custom avatar, custom username functionality
          customUsername, // set to undefined if you don't use custom username, but use custom avatar functionality
          customAvatar, // set to undefined if you don't use custom message
          false,           // if you want to convert HTML files to PNG set it as true, or remove it if you don't want to use this functionality
        );
        //SendTextResulttoDiscord
        // --------------------required part------------------------------
      });

      return config;
    },
    specPattern: 'cypress/e2e/**/*.cy.{js, jsx, ts, tsx}'
  },  
});
